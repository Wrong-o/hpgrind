{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{ResponsiveContainer}from'recharts';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const api=axios.create({baseURL:process.env.REACT_APP_API_URL,withCredentials:true});const HeatMap=_ref=>{let{onDataUpdate}=_ref;const[data,setData]=useState([]);const fetchHeatmapData=useCallback(async()=>{try{const response=await api.get('/get-user-heatmap');const processedData=response.data.map(item=>({x:item.x,y:item.y,value:item.correct_rate==='-'?null:parseFloat(item.correct_rate)}));setData(processedData);}catch(error){console.error(\"Error fetching heatmap data:\",error);}},[]);useEffect(()=>{fetchHeatmapData();},[fetchHeatmapData]);const updateHeatmapData=useCallback((x,y,isCorrect)=>{setData(prevData=>{const newData=[...prevData];const index=newData.findIndex(item=>item.x===x&&item.y===y);if(index!==-1){const currentValue=newData[index].value;const totalAttempts=currentValue!==null?1/currentValue:0;const newTotalAttempts=totalAttempts+1;const newCorrectAttempts=totalAttempts*currentValue+(isCorrect?1:0);newData[index]={...newData[index],value:newCorrectAttempts/newTotalAttempts};}else{newData.push({x,y,value:isCorrect?1:0});}return newData;});},[]);useEffect(()=>{if(onDataUpdate){onDataUpdate(updateHeatmapData);}},[onDataUpdate,updateHeatmapData]);const colorScale=value=>{if(value===null)return'#333333';// Darker gray for no data\nconst hue=(value*120).toString(10);return`hsl(${hue}, 80%, 50%)`;};const cellSize=40;const margin={top:20,right:20,bottom:30,left:30};return/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:500,children:/*#__PURE__*/_jsx(\"svg\",{width:\"100%\",height:\"100%\",style:{backgroundColor:'black'},children:/*#__PURE__*/_jsxs(\"g\",{transform:`translate(${margin.left},${margin.top})`,children:[data.map(item=>/*#__PURE__*/_jsx(\"rect\",{x:(item.x-1)*cellSize,y:(item.y-1)*cellSize,width:cellSize,height:cellSize,fill:colorScale(item.value),stroke:\"#000\",strokeWidth:1,children:/*#__PURE__*/_jsx(\"title\",{children:`${item.x} x ${item.y} = ${item.x*item.y}\n${item.value!==null?`Correct: ${(item.value*100).toFixed(1)}%`:'No data'}`})},`cell-${item.x}-${item.y}`)),[...Array(10)].map((_,i)=>/*#__PURE__*/_jsx(\"text\",{x:(i+0.5)*cellSize,y:10*cellSize+20,textAnchor:\"middle\",fill:\"#ffffff\",fontSize:\"12px\",children:i+1},`x-label-${i+1}`)),[...Array(10)].map((_,i)=>/*#__PURE__*/_jsx(\"text\",{x:-10,y:(i+0.5)*cellSize,textAnchor:\"end\",alignmentBaseline:\"middle\",fill:\"#ffffff\",fontSize:\"12px\",children:i+1},`y-label-${i+1}`))]})})});};export default HeatMap;","map":{"version":3,"names":["React","useState","useEffect","useCallback","ResponsiveContainer","axios","jsx","_jsx","jsxs","_jsxs","api","create","baseURL","process","env","REACT_APP_API_URL","withCredentials","HeatMap","_ref","onDataUpdate","data","setData","fetchHeatmapData","response","get","processedData","map","item","x","y","value","correct_rate","parseFloat","error","console","updateHeatmapData","isCorrect","prevData","newData","index","findIndex","currentValue","totalAttempts","newTotalAttempts","newCorrectAttempts","push","colorScale","hue","toString","cellSize","margin","top","right","bottom","left","width","height","children","style","backgroundColor","transform","fill","stroke","strokeWidth","toFixed","Array","_","i","textAnchor","fontSize","alignmentBaseline"],"sources":["C:/Users/jayb/Desktop/blogg/react/frontend/src/components/HeatMap.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { ResponsiveContainer } from 'recharts';\r\nimport axios from 'axios';\r\n\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL,\r\n  withCredentials: true,\r\n});\r\n\r\nconst HeatMap = ({ onDataUpdate }) => {\r\n  const [data, setData] = useState([]);\r\n\r\n  const fetchHeatmapData = useCallback(async () => {\r\n    try {\r\n      const response = await api.get('/get-user-heatmap');\r\n      const processedData = response.data.map(item => ({\r\n        x: item.x,\r\n        y: item.y,\r\n        value: item.correct_rate === '-' ? null : parseFloat(item.correct_rate)\r\n      }));\r\n      setData(processedData);\r\n    } catch (error) {\r\n      console.error(\"Error fetching heatmap data:\", error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchHeatmapData();\r\n  }, [fetchHeatmapData]);\r\n\r\n  const updateHeatmapData = useCallback((x, y, isCorrect) => {\r\n    setData(prevData => {\r\n      const newData = [...prevData];\r\n      const index = newData.findIndex(item => item.x === x && item.y === y);\r\n      if (index !== -1) {\r\n        const currentValue = newData[index].value;\r\n        const totalAttempts = currentValue !== null ? 1 / currentValue : 0;\r\n        const newTotalAttempts = totalAttempts + 1;\r\n        const newCorrectAttempts = (totalAttempts * currentValue + (isCorrect ? 1 : 0));\r\n        newData[index] = {\r\n          ...newData[index],\r\n          value: newCorrectAttempts / newTotalAttempts\r\n        };\r\n      } else {\r\n        newData.push({ x, y, value: isCorrect ? 1 : 0 });\r\n      }\r\n      return newData;\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (onDataUpdate) {\r\n      onDataUpdate(updateHeatmapData);\r\n    }\r\n  }, [onDataUpdate, updateHeatmapData]);\r\n\r\n  const colorScale = (value) => {\r\n    if (value === null) return '#333333'; // Darker gray for no data\r\n    const hue = ((value) * 120).toString(10);\r\n    return `hsl(${hue}, 80%, 50%)`;\r\n  };\r\n\r\n  const cellSize = 40;\r\n  const margin = { top: 20, right: 20, bottom: 30, left: 30 };\r\n\r\n  return (\r\n    <ResponsiveContainer width=\"100%\" height={500}>\r\n      <svg width=\"100%\" height=\"100%\" style={{backgroundColor: 'black'}}>\r\n        <g transform={`translate(${margin.left},${margin.top})`}>\r\n          {data.map((item) => (\r\n            <rect\r\n              key={`cell-${item.x}-${item.y}`}\r\n              x={(item.x - 1) * cellSize}\r\n              y={(item.y - 1) * cellSize}\r\n              width={cellSize}\r\n              height={cellSize}\r\n              fill={colorScale(item.value)}\r\n              stroke=\"#000\"\r\n              strokeWidth={1}\r\n            >\r\n              <title>{`${item.x} x ${item.y} = ${item.x * item.y}\r\n${item.value !== null ? `Correct: ${(item.value * 100).toFixed(1)}%` : 'No data'}`}</title>\r\n            </rect>\r\n          ))}\r\n          {[...Array(10)].map((_, i) => (\r\n            <text\r\n              key={`x-label-${i + 1}`}\r\n              x={(i + 0.5) * cellSize}\r\n              y={10 * cellSize + 20}\r\n              textAnchor=\"middle\"\r\n              fill=\"#ffffff\"\r\n              fontSize=\"12px\"\r\n            >\r\n              {i + 1}\r\n            </text>\r\n          ))}\r\n          {[...Array(10)].map((_, i) => (\r\n            <text\r\n              key={`y-label-${i + 1}`}\r\n              x={-10}\r\n              y={(i + 0.5) * cellSize}\r\n              textAnchor=\"end\"\r\n              alignmentBaseline=\"middle\"\r\n              fill=\"#ffffff\"\r\n              fontSize=\"12px\"\r\n            >\r\n              {i + 1}\r\n            </text>\r\n          ))}\r\n        </g>\r\n      </svg>\r\n    </ResponsiveContainer>\r\n  );\r\n};\r\n\r\nexport default HeatMap;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}