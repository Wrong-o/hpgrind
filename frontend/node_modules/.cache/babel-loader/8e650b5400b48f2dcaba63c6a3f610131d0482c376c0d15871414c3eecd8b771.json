{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{ResponsiveContainer,Tooltip,Rectangle,XAxis,YAxis,ScatterChart,Scatter}from'recharts';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const api=axios.create({baseURL:process.env.REACT_APP_API_URL,withCredentials:true});const HeatMap=()=>{const[heatmapData,setHeatmapData]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[containerSize,setContainerSize]=useState({width:0,height:0});const containerRef=useRef(null);useEffect(()=>{const fetchHeatmapData=async()=>{try{setLoading(true);const response=await api.get('/get-user-heatmap');console.log('API response:',response.data);// Debug log\nconst formattedData=response.data.map(item=>({x:parseInt(item.x),y:parseInt(item.y),value:item.correct_rate==='-'?null:parseFloat(item.correct_rate)}));setHeatmapData(formattedData);console.log('Formatted data:',formattedData);// Debug log\n}catch(error){console.error(\"Error fetching heatmap data:\",error);setError(error.message);}finally{setLoading(false);}};fetchHeatmapData();},[]);useEffect(()=>{const updateSize=()=>{if(containerRef.current){const newSize={width:containerRef.current.offsetWidth,height:containerRef.current.offsetHeight};console.log('Container size:',newSize);// Debug log\nsetContainerSize(newSize);}};updateSize();window.addEventListener('resize',updateSize);return()=>window.removeEventListener('resize',updateSize);},[]);const getColor=value=>{if(value===null)return'#000000';// Color for no data\nconst red=Math.floor(255*(1-value));const green=Math.floor(255*value);return`rgb(${red},${green},0)`;// Gradient from red to green\n};const CustomizedShape=props=>{const{x,y,width,height,value}=props;return/*#__PURE__*/_jsx(Rectangle,{x:x,y:y,width:width,height:height,fill:getColor(value)// Fill color based on value\n});};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading heatmap data...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error loading heatmap: \",error]});}if(heatmapData.length===0){return/*#__PURE__*/_jsx(\"div\",{children:\"No heatmap data available.\"});}return/*#__PURE__*/_jsx(\"div\",{ref:containerRef,className:\"w-full h-96 border border-gray-300\",children:containerSize.width>0&&containerSize.height>0?/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:\"100%\",children:/*#__PURE__*/_jsxs(ScatterChart,{margin:{top:20,right:20,bottom:20,left:20},children:[/*#__PURE__*/_jsx(XAxis,{type:\"number\",dataKey:\"x\",name:\"x\",unit:\"\"}),/*#__PURE__*/_jsx(YAxis,{type:\"number\",dataKey:\"y\",name:\"y\",unit:\"\"}),/*#__PURE__*/_jsx(Tooltip,{cursor:{strokeDasharray:'3 3'},content:_ref=>{let{payload}=_ref;if(payload&&payload.length){const data=payload[0].payload;return/*#__PURE__*/_jsxs(\"div\",{className:\"custom-tooltip bg-white p-2 border border-gray-300 rounded\",children:[/*#__PURE__*/_jsx(\"p\",{children:`X: ${data.x}, Y: ${data.y}`}),/*#__PURE__*/_jsx(\"p\",{children:`Correct Rate: ${data.value!==null?data.value.toFixed(2):'N/A'}`})]});}return null;}}),/*#__PURE__*/_jsx(Scatter,{data:heatmapData,shape:/*#__PURE__*/_jsx(CustomizedShape,{})})]})}):/*#__PURE__*/_jsx(\"div\",{children:\"Resizing...\"})});};export default HeatMap;","map":{"version":3,"names":["React","useState","useEffect","useRef","ResponsiveContainer","Tooltip","Rectangle","XAxis","YAxis","ScatterChart","Scatter","axios","jsx","_jsx","jsxs","_jsxs","api","create","baseURL","process","env","REACT_APP_API_URL","withCredentials","HeatMap","heatmapData","setHeatmapData","loading","setLoading","error","setError","containerSize","setContainerSize","width","height","containerRef","fetchHeatmapData","response","get","console","log","data","formattedData","map","item","x","parseInt","y","value","correct_rate","parseFloat","message","updateSize","current","newSize","offsetWidth","offsetHeight","window","addEventListener","removeEventListener","getColor","red","Math","floor","green","CustomizedShape","props","fill","children","length","ref","className","margin","top","right","bottom","left","type","dataKey","name","unit","cursor","strokeDasharray","content","_ref","payload","toFixed","shape"],"sources":["C:/Users/jayb/Desktop/blogg/react/frontend/src/components/HeatMap.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { ResponsiveContainer, Tooltip, Rectangle, XAxis, YAxis, ScatterChart, Scatter } from 'recharts';\r\nimport axios from 'axios';\r\n\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL,\r\n  withCredentials: true,\r\n});\r\n\r\nconst HeatMap = () => {\r\n  const [heatmapData, setHeatmapData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\r\n  const containerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const fetchHeatmapData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const response = await api.get('/get-user-heatmap');\r\n        console.log('API response:', response.data); // Debug log\r\n        const formattedData = response.data.map(item => ({\r\n          x: parseInt(item.x),\r\n          y: parseInt(item.y),\r\n          value: item.correct_rate === '-' ? null : parseFloat(item.correct_rate)\r\n        }));\r\n        setHeatmapData(formattedData);\r\n        console.log('Formatted data:', formattedData); // Debug log\r\n      } catch (error) {\r\n        console.error(\"Error fetching heatmap data:\", error);\r\n        setError(error.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchHeatmapData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const updateSize = () => {\r\n      if (containerRef.current) {\r\n        const newSize = {\r\n          width: containerRef.current.offsetWidth,\r\n          height: containerRef.current.offsetHeight\r\n        };\r\n        console.log('Container size:', newSize); // Debug log\r\n        setContainerSize(newSize);\r\n      }\r\n    };\r\n\r\n    updateSize();\r\n    window.addEventListener('resize', updateSize);\r\n    return () => window.removeEventListener('resize', updateSize);\r\n  }, []);\r\n\r\n  const getColor = (value) => {\r\n    if (value === null) return '#000000'; // Color for no data\r\n    const red = Math.floor(255 * (1 - value));\r\n    const green = Math.floor(255 * value);\r\n    return `rgb(${red},${green},0)`; // Gradient from red to green\r\n  };\r\n\r\n  const CustomizedShape = (props) => {\r\n    const { x, y, width, height, value } = props;\r\n    return (\r\n      <Rectangle\r\n        x={x}\r\n        y={y}\r\n        width={width}\r\n        height={height}\r\n        fill={getColor(value)} // Fill color based on value\r\n      />\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Loading heatmap data...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div>Error loading heatmap: {error}</div>;\r\n  }\r\n\r\n  if (heatmapData.length === 0) {\r\n    return <div>No heatmap data available.</div>;\r\n  }\r\n\r\n  return (\r\n    <div ref={containerRef} className=\"w-full h-96 border border-gray-300\">\r\n      {containerSize.width > 0 && containerSize.height > 0 ? (\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <ScatterChart\r\n            margin={{\r\n              top: 20,\r\n              right: 20,\r\n              bottom: 20,\r\n              left: 20,\r\n            }}\r\n          >\r\n            <XAxis type=\"number\" dataKey=\"x\" name=\"x\" unit=\"\" />\r\n            <YAxis type=\"number\" dataKey=\"y\" name=\"y\" unit=\"\" />\r\n            <Tooltip \r\n              cursor={{ strokeDasharray: '3 3' }}\r\n              content={({ payload }) => {\r\n                if (payload && payload.length) {\r\n                  const data = payload[0].payload;\r\n                  return (\r\n                    <div className=\"custom-tooltip bg-white p-2 border border-gray-300 rounded\">\r\n                      <p>{`X: ${data.x}, Y: ${data.y}`}</p>\r\n                      <p>{`Correct Rate: ${data.value !== null ? data.value.toFixed(2) : 'N/A'}`}</p>\r\n                    </div>\r\n                  );\r\n                }\r\n                return null;\r\n              }}\r\n            />\r\n            <Scatter data={heatmapData} shape={<CustomizedShape />} />\r\n          </ScatterChart>\r\n        </ResponsiveContainer>\r\n      ) : (\r\n        <div>Resizing...</div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeatMap;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}